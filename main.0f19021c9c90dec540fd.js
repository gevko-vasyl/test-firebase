(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"38EF":function(e,t,n){var o=n("mp5j");e.exports=(o.default||o).template({1:function(e,t,n,o,a){var r,i=null!=t?t:e.nullContext||{},c=e.hooks.helperMissing,s=e.escapeExpression,u=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<li class="movie-card">\r\n    <img class="movie-poster" width="100px" src=https://image.tmdb.org/t/p/w500'+s("function"==typeof(r=null!=(r=u(n,"poster_path")||(null!=t?u(t,"poster_path"):t))?r:c)?r.call(i,{name:"poster_path",hash:{},data:a,loc:{start:{line:3,column:79},end:{line:3,column:94}}}):r)+' alt="'+s("function"==typeof(r=null!=(r=u(n,"title")||(null!=t?u(t,"title"):t))?r:c)?r.call(i,{name:"title",hash:{},data:a,loc:{start:{line:3,column:100},end:{line:3,column:109}}}):r)+'" data-movie-id="'+s("function"==typeof(r=null!=(r=u(n,"id")||(null!=t?u(t,"id"):t))?r:c)?r.call(i,{name:"id",hash:{},data:a,loc:{start:{line:3,column:126},end:{line:3,column:132}}}):r)+'">\r\n    <h1 class="movie-title">'+s("function"==typeof(r=null!=(r=u(n,"title")||(null!=t?u(t,"title"):t))?r:c)?r.call(i,{name:"title",hash:{},data:a,loc:{start:{line:4,column:28},end:{line:4,column:37}}}):r)+"</h1>\r\n</li>\r\n"},compiler:[8,">= 4.3.0"],main:function(e,t,n,o,a){var r;return null!=(r=(e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]})(n,"each").call(null!=t?t:e.nullContext||{},t,{name:"each",hash:{},fn:e.program(1,a,0),inverse:e.noop,data:a,loc:{start:{line:1,column:0},end:{line:6,column:9}}}))?r:""},useData:!0})},L1EO:function(e,t,n){},QfWi:function(e,t,n){"use strict";n.r(t);n("IvQZ"),n("4NM0"),n("L1EO");var o=n("SzhR"),a=(n("VwVG"),n("SHTW"),{gallery:document.querySelector(".gallery"),home:document.getElementById("home"),library:document.getElementById("library"),watched:document.getElementById("watched"),queue:document.getElementById("queue"),lightBox:document.querySelector(".lightbox")}),r=document.querySelector("#sign_in"),i=document.querySelector("#sign_out"),c=document.querySelector(".user-info");function s(e){return o.a.database().ref("/users/"+e).once("value")}o.a.initializeApp({apiKey:"AIzaSyB_XQuuXpnCVMzsoH_tRJd_Re2w7D-8sJE",authDomain:"test-ec373.firebaseapp.com",databaseURL:"https://test-ec373-default-rtdb.firebaseio.com",projectId:"test-ec373",storageBucket:"test-ec373.appspot.com",messagingSenderId:"655424318049",appId:"1:655424318049:web:e8ade1934133d874e6d820",measurementId:"G-RN92T8LBYY"}),r.addEventListener("click",(function(){var e=new o.a.auth.GoogleAuthProvider;o.a.auth().signInWithPopup(e).then((function(e){e.credential.accessToken;var t=e.user,n=t.uid,a=t.displayName,r=t.email,i=t.photoURL;console.log(t),console.log("Success!"),function(){var e=o.a.auth().currentUser.uid;return o.a.database().ref("/users/"+e).once("value")}().then((function(e){e.exists()?(console.log("User exist in database"),s(n)):(console.log("User NOT exist in database"),function(e,t,n,a){o.a.database().ref("users/"+e).set({username:t,email:n,profile_picture:a},(function(e){e?console.log("FAILED!!!"):console.log("SUCCESS")}))}(n,a,r,i))}))})).catch((function(e){e.code;var t=e.message;e.email,e.credential;console.log(t),console.log("Failed!")}))})),i.addEventListener("click",(function(){o.a.auth().signOut().then((function(){console.log("Sign-out successful."),window.location.href="index.html",c.innerHTML=""})).catch((function(e){console.log("ERRROR!")}))}));n("JBxO"),n("FdtR");var u=n("38EF"),l=n.n(u);function d(){return fetch("https://api.themoviedb.org/3/trending/movie/week?api_key=50b81e1c6c3b9e5f74d2015b742ff0b0&page=1").then((function(e){return e.json()})).then((function(e){var t=e.results;a.gallery.innerHTML=l()(t)})).catch((function(e){return console.log(e)}))}n("hi3g");function h(){var e=o.a.auth().currentUser;if(console.log(e),e){var t=e.uid,n=localStorage.getItem("firebase-id");console.log(n),s(t).then((function(e){return e.val()})).then((function(e){var o=e.queue||[];o.includes(n)||m(t,[].concat(o,[n]))}))}}function f(e,t){o.a.database().ref("users/"+e).update({watched:t},(function(e){e?console.log("FAIL!"):console.log("DATA UPDATE SUCCESSFULLY")}))}function m(e,t){o.a.database().ref("users/"+e).update({queue:t},(function(e){e?console.log("FAIL!"):console.log("DATA UPDATE SUCCESSFULLY")}))}n("uQK7"),n("/YXa"),n("lmye"),n("Xlt+"),n("WoWj"),n("U00V"),n("wcNg");function p(){a.gallery.innerHTML="",o.a.auth().currentUser&&s(o.a.auth().currentUser.uid).then((function(e){return e.val()})).then(function(){var e=L(regeneratorRuntime.mark((function e(t){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.watched){e.next=7;break}return n=t.watched,e.next=4,Promise.all(n.map(function(){var e=L(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.themoviedb.org/3/movie/"+t+"?api_key=50b81e1c6c3b9e5f74d2015b742ff0b0&");case 2:return n=e.sent,e.abrupt("return",n.json());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:o=e.sent,console.log(o),o.map((function(e){E([{id:e.id,title:e.title,poster_path:e.poster_path}])}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return console.log("error")}));var e=document.querySelector(".movie-card");console.log(e),a.watched.setAttribute("disabled","true"),a.queue.removeAttribute("disabled")}function v(){a.gallery.innerHTML="",o.a.auth().currentUser&&s(o.a.auth().currentUser.uid).then((function(e){return e.val()})).then(function(){var e=L(regeneratorRuntime.mark((function e(t){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.queue){e.next=7;break}return n=t.queue,e.next=4,Promise.all(n.map(function(){var e=L(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.themoviedb.org/3/movie/"+t+"?api_key=50b81e1c6c3b9e5f74d2015b742ff0b0&");case 2:return n=e.sent,e.abrupt("return",n.json());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:o=e.sent,console.log(o),o.map((function(e){E([{id:e.id,title:e.title,poster_path:e.poster_path}])}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return console.log("error")})),a.watched.removeAttribute("disabled"),a.queue.setAttribute("disabled","true")}function g(e,t,n,o,a,r,i){try{var c=e[r](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(o,a)}function L(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var r=e.apply(t,n);function i(e){g(r,o,a,i,c,"next",e)}function c(e){g(r,o,a,i,c,"throw",e)}i(void 0)}))}}function b(e){e.removeEventListener("click",event)}function w(e,t){e.addEventListener("click",(function(n){e.classList.add("hide"),t.classList.remove("hide"),function(){var e=o.a.auth().currentUser;if(console.log(e),e){var t=e.uid,n=localStorage.getItem("firebase-id");console.log(n),s(t).then((function(e){return e.val()})).then((function(e){var o=e.watched||[];o.includes(n)||f(t,[].concat(o,[n]))}))}}(),b(e)})),t.addEventListener("click",(function(n){e.classList.remove("hide"),t.classList.add("hide"),function(){var e=o.a.auth().currentUser;if(e){var t=e.uid,n=localStorage.getItem("firebase-id");s(t).then((function(e){return e.val()})).then((function(e){if(e.watched){var o=e.watched||[];if(o.includes(n)){var a=o.indexOf(n);o.splice(a,1),console.log("NEW WATCHED",o)}f(t,[].concat(o))}})),console.log(watched)}}(),b(t)}))}function y(){var e=o.a.auth().currentUser;if(e){var t=e.uid,n=localStorage.getItem("firebase-id");s(t).then((function(e){return e.val()})).then((function(e){if(e.queue){var o=e.queue||[];if(o.includes(n)){var a=o.indexOf(n);o.splice(a,1),console.log("NEW QUEUE",o)}m(t,[].concat(o))}})),console.log(queue)}}function E(e){var t=l()(e);a.gallery.insertAdjacentHTML("beforeend",t)}function x(e){if("IMG"===e.target.nodeName){a.lightBox.classList.add("is-open");var t=e.target.dataset.movieId;localStorage.setItem("firebase-id",t);var n,r,i=a.lightBox.querySelector("li button"),c=a.lightBox.querySelector("li:nth-last-child(3) button"),u=a.lightBox.querySelector("li:nth-last-child(2) button"),l=a.lightBox.querySelector("li:last-child button");console.log(i),console.log(c),console.log(u),console.log(l),function(e,t,n,a,r){var i=o.a.auth().currentUser;if(!i)return;s(i.uid).then((function(e){return e.val()})).then((function(o){if(o.watched||o.queue){console.log("we are in!");var i=o.watched||[],c=o.queue||[];console.log("ok"),i.includes(e)?t.classList.contains("hide")||(t.classList.add("hide"),n.classList.remove("hide")):(t.classList.remove("hide"),n.classList.add("hide")),c.includes(e)?a.classList.contains("hide")||(a.classList.add("hide"),r.classList.remove("hide")):(a.classList.remove("hide"),r.classList.add("hide"))}}))}(t,i,c,u,l),w(i,c),r=l,(n=u).addEventListener("click",(function(){n.classList.add("hide"),r.classList.remove("hide"),h()})),r.addEventListener("click",(function(){n.classList.remove("hide"),r.classList.add("hide"),y()}))}}o.a.auth().onAuthStateChanged((function(e){if(e){var t=e.displayName,n=e.photoURL,o=(e.email,e.uid);c.innerHTML='<img class="user-img" src="'+n+'">\n           <p>'+t+"</p>",console.log("Current user: "+t,"userId: "+o),s(o)}else c.innerHTML=""})),d(),a.gallery.addEventListener("click",x),a.lightBox.addEventListener("click",(function(e){"lightbox__overlay"===e.target.className&&a.lightBox.classList.remove("is-open"),"add-queue"===e.target.id&&h()})),a.library.addEventListener("click",(function(){a.gallery.innerHTML="",a.watched.classList.remove("hide"),a.queue.classList.remove("hide"),a.watched.removeAttribute("disabled"),p()})),a.home.addEventListener("click",(function(){a.watched.classList.add("hide"),a.queue.classList.add("hide"),d()})),a.watched.addEventListener("click",(function(){p(),a.queue.classList.remove("active-queue"),a.watched.classList.add("active-watch")})),a.queue.addEventListener("click",(function(){v(),a.watched.classList.remove("active-watch"),a.queue.classList.add("active-queue")}))}},[["QfWi",1,2]]]);
//# sourceMappingURL=main.0f19021c9c90dec540fd.js.map